import serial
import struct
import time

PORT = 'COM4'       # Change to your serial port
BAUDRATE = 115200
NUM_FLOATS = 141

# Your actual float data array here:
float_values = [
    -0.032245388, -0.54504988, -0.82233951, -1.6050845, -1.8057748, -2.0080666,
    -2.2339748, -2.191458, -2.0580713, -1.8808487, -1.5980847, -1.0734666,
    -0.60601763, -0.40062774, -0.30974032, -0.27599315, -0.16190422, 0.10850521,
    0.30977527, 0.41252896, 0.53814803, 0.54247379, 0.42785112, 0.37815942,
    0.36188738, 0.37976272, 0.45375055, 0.5483923, 0.67794169, 0.66825595,
    0.4131611, 0.22767328, 0.27982432, 0.35898388, 0.40398305, 0.43035215,
    0.40867432, 0.42049766, 0.42107193, 0.32161806, 0.22971489, 0.20655718,
    0.22594547, 0.34068889, 0.44956444, 0.40496562, 0.30956912, 0.24239092,
    0.17865089, 0.18501601, 0.33981574, 0.51298385, 0.47234082, 0.24335581,
    0.082250646, 0.041823061, 0.04329214, 0.16040296, 0.26450173, 0.21102713,
    0.22029886, 0.31735332, 0.31367233, 0.31088657, 0.38498299, 0.36784817,
    0.2984939, 0.31753582, 0.32696731, 0.29884615, 0.3674174, 0.47894802,
    0.51140793, 0.49840732, 0.49130584, 0.50073549, 0.49360933, 0.53874692,
    0.63148766, 0.57849716, 0.53415701, 0.6395139, 0.67505033, 0.5978203,
    0.48834268, 0.39688329, 0.42172264, 0.51001168, 0.55461096, 0.59630145,
    0.57140413, 0.45837937, 0.44734872, 0.50965739, 0.53081508, 0.51322441,
    0.46546407, 0.49637166, 0.60659122, 0.66603659, 0.62919292, 0.54553078,
    0.54543892, 0.60964795, 0.59777943, 0.57261331, 0.60459362, 0.57085274,
    0.48861488, 0.48893631, 0.51936437, 0.55129762, 0.61166333, 0.61427183,
    0.55032934, 0.48756962, 0.41517402, 0.39897417, 0.53464846, 0.66442392,
    0.63454566, 0.56613755, 0.47991327, 0.29107729, 0.10251066, 0.018347409,
    0.043036237, 0.038287591, -0.168029, -0.44347067, -0.90642467, -1.6213757,
    -2.3290905, -3.0498941, -3.6204134, -4.2104818, -4.043785, -3.0518127,
    -2.8068663, -0.87966639, -0.032245388
]

with serial.Serial(PORT, BAUDRATE, timeout=3) as ser:
    time.sleep(2)  # wait for device ready

    ser.reset_input_buffer()
    ser.reset_output_buffer()

    data_bytes = struct.pack('<' + 'f'*NUM_FLOATS, *float_values)
    ser.write(data_bytes)
    ser.flush()

    # Read exactly 2 bytes for the report from MCU
    report = ser.read(2)

    print("Report bytes:", report)
    print("Status:", report[0])
    print("Similarity:", report[1])